<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des Patients</title>
</head>
<body>
    <h1>Liste des Patients</h1>
    <ul id="patientsList">
        <!-- Les éléments de la liste des patients seront ajoutés ici dynamiquement -->
    </ul>

    <script>
        async function fetchAllPatientInfo() {
            try {
                const response = await fetch('/all-patient-info');
                if (response.ok) {
                    return await response.json();
                } else {
                    console.error('Erreur lors de la récupération des informations des patients:', response.statusText);
                    return [];
                }
            } catch (error) {
                console.error('Erreur lors de la récupération des informations des patients:', error);
                return [];
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            const patientsList = document.getElementById('patientsList');

            // Récupérer les informations de tous les patients
            const patientInfos = await fetchAllPatientInfo();

            // Ajouter les éléments de liste pour chaque patient
            patientInfos.forEach(patient => {
                const listItem = document.createElement('li');
                listItem.textContent = `Patient ${patient.name}`;
                patientsList.appendChild(listItem);
            });

            // Ajouter un gestionnaire d'événement pour rediriger vers la page patient.html avec l'ID du patient
            patientsList.addEventListener('click', (event) => {
                const listItem = event.target;
                const patientIndex = Array.from(patientsList.children).indexOf(listItem);

                if (patientIndex !== -1) {
                    const patientId = patientInfos[patientIndex].id;
                    window.location.href = `patient.html?id=${patientId}`;
                }
            });
        });
    </script>
</body>
</html>
